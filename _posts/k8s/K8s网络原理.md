问题：

- Kubernetes的网络模型是什么？
- Docker背后的网络基础是什么？
- Docker自身的网络模型和局限是什么？
- Kubernetes的网络组件之间是怎么通信的？
- 外部如何访问Kubernetes集群？
- 有哪些开源组件支持Kubernetes的网络模型？



## Kubernetes网络模型

> 我们都知道，在Kubernetes里IP是以Pod为单位进行分配的，一个Pod内部的所有容器共享一个网络堆栈，按照这个网络原则抽象出来的为每个Pod都设置一个IP地址的模型被称作IP-per-Pod模型。
>
> 为每个Pod都设置一个IP地址的模型还有另一层含义，那就是同一个Pod内的不通容器会共享同一个网络命名空间，也就是同一个Linux网络协议栈。这就意味着同一个Pod内的容器可以通过localhost连接对象的端口。

IP-pre-Pod模式和Docker原生的通过动态端口映射方式实现的多节点访问模式的主要区别是：

- Docker中的动态端口映射会引入端口管理的复杂性，访问者看到的IP地址和端口与服务提供者实际绑定的不同（NAT的缘故）；
- 标准的DNS等名字解析服务不再适用，负责注册和发现机制会更加复杂（在端口映射情况下，服务很难知道自己对外暴露的真实服务IP和端口，外部也无法通过服务所在容易的私有IP地址和端口来访问服务。）

Kubernetes对集群网络的要求:

> 1. 所有Pod都可以在不用NAT的方式下与别的Pod通信；
> 2. 在所有节点上运行的代理程序都可以在不用NAT的方式下同所有Pod通信，反之亦然；
> 3. 以HostNetwork模式运行的Pod都可以在不用NAT的方式下同别的Pod通信。

## Docker网络基础

### 网络命名空间

>  Docker利用网络的命名空间特性，实现了不同容器之间的网络隔离。

Veth设备对

> 引入Veth设备对是为了在不通的网络命名空间之间通信，利用它可以直接将良哥网络命名空间连接起来。

网桥

>